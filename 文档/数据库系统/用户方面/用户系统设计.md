# 用户系统数据库设计

## 用户表 (shujubiao_yonghu)

管理系统用户的账号信息，通过用户组ID关联权限控制。

| 字段名 | 昵称 | 说明 | 类型 | 默认值 |
|---|---|---|---|---|
| `id` | 用户ID | 用户唯一标识 | `BIGSERIAL PRIMARY KEY` | 无 |
| `zhanghao` | 账号 | 登录账号，唯一 | `TEXT NOT NULL UNIQUE` | 无 |
| `mima` | 密码 | 登录密码，明文存储 | `TEXT NOT NULL` | 无 |
| `nicheng` | 昵称 | 用户显示名称 | `TEXT NOT NULL` | 无 |
| `touxiang` | 头像 | 头像地址 | `TEXT` | 无 |
| `youxiang` | 邮箱 | 联系邮箱 | `TEXT` | 无 |
| `yonghuzuid` | 用户组ID | 关联的用户组 | `TEXT NOT NULL` | 无 |
| `fengjin` | 封禁状态 | 是否被封禁，1封禁 0正常 | `TEXT NOT NULL` | `0` |
| `fengjinyuanyin` | 封禁原因 | 封禁的具体原因说明 | `TEXT` | 无 |
| `fengjinjieshu` | 封禁结束时间 | 封禁到期的时间戳，为空表示永久封禁 | `TEXT` | 无 |
| `kuozhan` | 扩展信息 | 扩展JSON字段，用于存储额外信息 | `TEXT NOT NULL` | `{}` |
| `zuihoudenglu` | 最后登录 | 最后一次登录时间戳 | `TEXT` | 无 |
| `beizhu` | 备注 | 补充说明 | `TEXT` | 无 |
| `chuangjianshijian` | 创建时间 | 记录创建时间 | `TEXT NOT NULL` | 无 |
| `gengxinshijian` | 更新时间 | 记录最后更新时间 | `TEXT NOT NULL` | 无 |

## 用户组表 (shujubiao_yonghuzu)

管理用户组的权限配置，通过黑名单控制组内用户的接口访问权限。默认所有接口放行，仅禁止列表中的接口。

| 字段名 | 昵称 | 说明 | 类型 | 默认值 |
|---|---|---|---|---|
| `id` | 用户组ID | 用户组唯一标识 | `BIGSERIAL PRIMARY KEY` | 无 |
| `mingcheng` | 组名称 | 用户组显示名称，如"管理员"、"普通用户" | `TEXT NOT NULL UNIQUE` | 无 |
| `jinjiekou` | 禁用接口 | 黑名单，不允许访问的接口路径列表，JSON数组格式 | `TEXT NOT NULL` | `[]` |
| `morenzhu` | 默认组 | 是否为默认用户组，1是 0否，全局仅一个 | `TEXT NOT NULL` | `0` |
| `kuozhan` | 扩展信息 | 扩展JSON字段，用于存储额外信息 | `TEXT NOT NULL` | `{}` |
| `beizhu` | 备注 | 补充说明 | `TEXT` | 无 |
| `chuangjianshijian` | 创建时间 | 记录创建时间 | `TEXT NOT NULL` | 无 |
| `gengxinshijian` | 更新时间 | 记录最后更新时间 | `TEXT NOT NULL` | 无 |

## 关联关系

```
用户组表 (1) ──── (N) 用户表
  id         <────  yonghuzuid
```

- 用户表的 `yonghuzuid` 字段关联用户组表的 `id`，一个用户组可以包含多个用户（一对多）
- 用户必须归属一个用户组，用户组决定该用户的接口访问权限
- 用户组的 `jinjiekou` 为黑名单机制，不在列表中的接口默认放行
- 删除用户组前需确保该组下无用户，或先将用户迁移至其他组
- 用户的封禁状态独立于用户组，封禁优先级高于用户组权限（即使用户组允许，封禁用户也无法访问）
- `fengjinyuanyin` 和 `fengjinjieshu` 仅当 `fengjin = '1'` 时有意义，`fengjinjieshu` 为空表示永久封禁，有值表示到期自动解封
- 用户组的 `morenzhu` 全局只能有一个为 `'1'`，新用户注册时自动分配到默认组
