# PostgreSQL 常见问题

## template1 collation 版本不匹配

当系统升级过 glibc 后，PostgreSQL 的模板数据库 `template1` 的 collation 版本会与当前系统不一致，导致 `CREATE DATABASE` 失败。

错误信息：
```
ERROR: template database "template1" has a collation version mismatch
DETAIL: The template database was created using collation version 2.41, but the operating system provides version 2.42.
```

修复命令：
```sql
ALTER DATABASE template1 REFRESH COLLATION VERSION;
```

## bigint 列使用 text 参数绑定导致 WHERE 条件失效

由于 `psqlcaozuo` 的参数统一使用 `&str` 绑定，当表的 `id` 列类型为 `bigint` 时，`WHERE id = $1` 会变成 `bigint = text` 的比较。PostgreSQL 不会对此做隐式类型转换，导致条件匹配不到任何行，UPDATE/DELETE/SELECT 静默返回空结果。

表现：SQL 执行不报错，但影响行数为 0，数据没有任何变化。

修复方式：在 SQL 中对参数显式转换类型。

```sql
-- 错误写法
WHERE id = $1

-- 正确写法
WHERE id = $1::BIGINT
```
